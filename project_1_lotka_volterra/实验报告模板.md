# 项目1实验报告：Lotka-Volterra捕食者-猎物模型

**学生姓名：** [樊一川]  
**学号：** [20221050017]  
**完成日期：** [2025/5/28]  
**实验时间：** [40min]

---

## 1. 实验目的

本实验旨在通过数值方法求解Lotka-Volterra捕食者-猎物模型，掌握以下内容：

- 理解生物种群动力学的数学建模方法
- 学习将高阶常微分方程组转换为一阶方程组的标准形式
- 掌握多种数值方法求解常微分方程组（欧拉法、改进欧拉法、4阶龙格-库塔法）
- 比较不同数值方法的精度和稳定性
- 分析生态系统中捕食者与猎物的相互作用规律

## 2. 理论背景

### 2.1 Lotka-Volterra方程组

请简要描述Lotka-Volterra方程组的数学形式和各参数的生物学意义：

数学模型：

$$
\begin{cases}
\frac{dx}{dt} = \alpha x - \beta xy \\
\frac{dy}{dt} = \delta xy - \gamma y
\end{cases}
$$

参数意义：
| 符号 | 生物学意义         | 本实验取值 |
|------|------------------|----------|
| α    | 猎物增长率        | 1.0      |
| β    | 捕食效率系数      | 0.5      |
| γ    | 捕食者死亡率      | 0.5      |
| δ    | 能量转化效率      | 2.0      |


### 2.2 数值方法原理

请简要说明您实现的三种数值方法的基本原理：

**欧拉法：**

基本思想：用当前点的斜率线性外推

$y_{n+1} = y_n + hf(t_n, y_n)$

优点：实现简单；缺点：精度低（一阶）



**改进欧拉法：**

先用欧拉法预测，再用预测点的斜率校正：

$y_{n+1}^* = y_n + hf(t_n, y_n)$

$y_{n+1} = y_n + \frac{h}{2} \left[ f(t_n, y_n) + f(t_{n+1}, y_{n+1}^*) \right]$

精度提高到二阶

**4阶龙格-库塔法：**

通过4个斜率加权平均：

$$
\begin{align}
k_1 = f(t_n, y_n) \\
k_2 = f\left(t_n + \frac{h}{2}, y_n + \frac{h k_1}{2}\right) \\
k_3 = f\left(t_n + \frac{h}{2}, y_n + \frac{h k_2}{2}\right) \\
k_4 = f\left(t_n + h, y_n + h k_3\right) \\
y_{n+1} = y_n + \frac{h}{6} \left(k_1 + 2k_2 + 2k_3 + k_4\right)
\end{align}
$$

优势：四阶精度，稳定性好

## 3. 实验方法与实现

### 3.1 参数设置

根据题目要求，本实验使用以下参数：

- 模型参数：α = 1.0, β = 0.5, γ = 0.5, δ = 2.0
- 初始条件：x₀ = 2.0, y₀ = 2.0
- 时间范围：t ∈ [0, 30]
- 时间步长：dt = 0.01

### 3.2 核心算法实现

请在此处粘贴您实现的核心函数代码片段（选择最重要的1-2个函数）：

```python
# 例如：lotka_volterra_system函数
def lotka_volterra_system(state: np.ndarray, t: float, alpha: float, beta: float, gamma: float, delta: float) -> np.ndarray:
    x, y = state
    dxdt = alpha * x - beta * x * y
    dydt = gamma * x * y - delta * y
    return np.array([dxdt, dydt])
```

```python
# 例如：runge_kutta_4函数
def runge_kutta_4(f, y0: np.ndarray, t_span: Tuple[float, float], dt: float, *args) -> Tuple[np.ndarray, np.ndarray]:
    t_start, t_end = t_span
    t = np.arange(t_start, t_end + dt, dt)
    n_steps = len(t)
    n_vars = len(y0)
    y = np.zeros((n_steps, n_vars))
    y[0] = y0
    for i in range(n_steps - 1):
        k1 = dt * f(y[i], t[i], *args)
        k2 = dt * f(y[i] + k1/2, t[i] + dt/2, *args)
        k3 = dt * f(y[i] + k2/2, t[i] + dt/2, *args)
        k4 = dt * f(y[i] + k3, t[i] + dt, *args)
        y[i+1] = y[i] + (k1 + 2*k2 + 2*k3 + k4) / 6
    return t, y

```

### 3.3 实现过程中遇到的问题

请描述您在实现过程中遇到的主要问题及解决方法：

对于不同参数造成的影响不是很清晰。
加入了不同参数对相空间影响的可视化，结果更直观。


## 4. 实验结果

### 4.1 基本求解结果

请在此处粘贴使用4阶龙格-库塔法求解得到的种群动力学图：
![Figure_2](https://github.com/user-attachments/assets/0ee20a22-6a55-485b-8a3e-1b481fd7a865)


```
图4.1: Lotka-Volterra种群动力学
左图：种群数量随时间变化；右图：相空间轨迹
```

**观察结果描述：**
```
[请描述图中观察到的现象，如周期性变化、相位关系等]
```
观察到明显的周期性振荡

捕食者峰值滞后于猎物峰值约1/4周期

相空间呈现闭合轨道

### 4.2 数值方法比较

请在此处粘贴三种数值方法的比较图：
```
[请粘贴方法比较图]
图4.2: 三种数值方法比较
上排：时间序列比较；下排：相空间比较
```
![Figure_3](https://github.com/user-attachments/assets/0b8d39e1-c240-43e5-a7e1-45de10e8f096)

**比较结果分析：**

| 方法 | 计算精度 | 计算效率 | 稳定性 | 守恒量误差 |
|------|----------|----------|--------|------------|
| 欧拉法         | 低，误差较大              | 快，运算量最小     | 差，步长大易发散 | 较大，守恒量波动明显 |
| 改进欧拉法     | 中等，误差较欧拉法小      | 较快，运算量适中   | 较好，步长可适中 | 中等，守恒量有波动   |
| 4阶Runge-Kutta | 高，误差最小              | 慢，运算量最大     | 最好，步长可较大 | 最小，守恒量最平稳   |

**说明：**
- 计算精度：RK4 > 改进欧拉 > 欧拉。
- 计算效率：欧拉 > 改进欧拉 > RK4。
- 稳定性：RK4 > 改进欧拉 > 欧拉。
- 守恒量误差：RK4最优，欧拉最差。

欧拉法最大误差: 2.8184e+00

改进欧拉法最大误差: 2.8822e-03

### 4.3 参数影响分析

请在此处粘贴不同初始条件下的结果图：

```
[请粘贴参数分析图]
图4.3: 不同初始条件的影响
```
![Figure_4](https://github.com/user-attachments/assets/0f42d9ac-ce64-435d-b091-4dc1fc5e1ca1)

**参数敏感性分析：**
```
[请分析不同初始条件对系统行为的影响]
```
捕食者初始比例越大，相空间轨迹半径越大

初始种群比例影响振幅但周期不变

## 5. 结果分析与讨论

### 5.1 生物学意义分析

请从生物学角度分析实验结果：

**种群动力学特征：**
```
[请分析猎物和捕食者数量变化的规律]
```
实验结果显示猎物和捕食者数量呈现周期性振荡：
1. 猎物数量先增长，为捕食者提供充足食物
2. 捕食者数量随后增长，导致猎物被捕食压力增大
3. 捕食者数量下降后，猎物得以恢复
这种循环周期约为10-15个时间单位（取决于参数设置）

**相互作用机制：**
```
[请解释捕食者与猎物之间的相位关系]
```
相位关系表现为：
- 猎物峰值总是超前捕食者峰值约1/4周期（90°相位差）

- 这种滞后反映生态响应延迟：

  • 猎物繁殖需要时间

  • 捕食者种群增长需要积累足够食物能量
  

**生态平衡：**
```
[请讨论系统的稳定性和平衡状态]
```
系统表现出：
1. 中性稳定性：扰动后会产生新周期轨道
2. 平衡点（x*=γ/δ=0.25, y*=α/β=2.0）为中心点
3. 现实中的限制因素（环境承载力、年龄结构等）会使模型更稳定

### 5.2 数值方法评估

**精度比较：**
```
[请比较三种方法的精度，并解释原因]
```
• 欧拉法：一阶精度，误差O(h)，相轨迹会螺旋偏离

• 改进欧拉法：二阶精度，误差O(h²)，周期性保持较好

• RK4法：四阶精度，误差O(h⁴)，即使大步长也能保持轨道闭合

精度差异源于泰勒展开的截断阶数不同

**计算效率：**
```
[请比较计算时间和资源消耗]
```
计算时间对比（模拟30个时间单位）：
| 方法       | 函数调用次数 | 相对耗时 |
|------------|-------------|---------|
| 欧拉法     | 3000        | 1×      |
| 改进欧拉法 | 6000        | 1.8×    |
| RK4        | 12000       | 3.5×    |

**适用性分析：**
```
[请讨论在什么情况下选择哪种方法]
```
方法选择建议：
1. 快速原型开发 → 欧拉法
2. 中等精度要求 → 改进欧拉法
3. 长期预测/科研 → RK4
4. 刚性问题 → 隐式方法

## 6. 思考题

请回答以下思考题：

### 6.1 周期性分析
**问题：** 为什么Lotka-Volterra系统会表现出周期性行为？这种周期性在现实生态系统中是否存在？

**回答：**
```
[请回答]
```
**周期性产生机制：**
1. 非线性耦合：捕食项xy创造反馈回路
2. 能量流动延迟：生物量转化需要时间
3. 守恒量存在：系统存在第一积分V=δx-γlnx+βy-αlny

**现实存在性：**

• 实验室环境：已观测到（如藻类-轮虫系统）

• 自然生态系统：
  
  - 通常被随机扰动破坏
  
  - 需要满足严格条件：

    ✓ 封闭环境

    ✓ 无其他物种干扰

    ✓ 参数恒定
  
  - 典型实例：加拿大猞猁-雪兔周期（约10年）


**实验报告完成情况自评：**

- [✓ ] 完成了所有必需的函数实现
- [✓] 通过了所有测试用例
- [✓ ] 生成了所有要求的图表
- [✓ ] 完成了结果分析和讨论
- [✓ ] 回答了所有思考题

**总体评价：** [请对自己的实验完成情况进行总体评价]

代码清晰，完成了要求。实验报告完整，结果不错。

**建议成绩：** [98] / 100分
